\RequirePackage{xspace}
\RequirePackage{nicefrac}
\RequirePackage{mathtools}
\RequirePackage{etoolbox}


% Spaces

\newcommand*{\SPACE}[1]{\ensuremath{#1}}

\newcommand*{\HILBERT}[2]{{\ensuremath{\SPACE{H}^{#1}\left( #2 \right)}}}
\newcommand*{\SOBOLEV}[3]{{\ensuremath{\SPACE{W}^{#1, #2} \left( #3 \right)}}}
\newcommand*{\BV}{{\ensuremath{\text{BV}}}}
\newcommand*{\SPCX}{{\SPACE{X}}}
\newcommand*{\SPCY}{{\SPACE{Y}}}
\newcommand*{\SPCZ}{{\SPACE{Z}}}

\newcommand*{\DUAL}[1]{\ensuremath{#1^*}}

\newcommand*{\LINOP}[2]{{L(#1, #2)}}
\newcommand*{\BLINOP}[2]{{\SPCL(#1, #2)}}

% Operators

\newcommand*{\OP}[1]{\ensuremath{\mathcal{#1}}}

\newcommand*{\OPA}{{\OP{A}}}
\newcommand*{\OPB}{{\OP{B}}}
\newcommand*{\OPC}{{\OP{C}}}
\newcommand*{\OPD}{{\OP{D}}}
\newcommand*{\OPE}{{\OP{E}}}
\newcommand*{\OPF}{{\OP{F}}}
\newcommand*{\OPG}{{\OP{G}}}
\newcommand*{\OPH}{{\OP{H}}}
\newcommand*{\OPI}{{\OP{I}}}
\newcommand*{\OPJ}{{\OP{J}}}
\newcommand*{\OPK}{{\OP{K}}}
\newcommand*{\OPL}{{\OP{L}}}
\newcommand*{\OPM}{{\OP{M}}}
\newcommand*{\OPN}{{\OP{N}}}
\newcommand*{\OPO}{{\OP{O}}}
\newcommand*{\OPP}{{\OP{P}}}
\newcommand*{\OPQ}{{\OP{Q}}}
\newcommand*{\OPR}{{\OP{R}}}
\newcommand*{\OPS}{{\OP{S}}}
\newcommand*{\OPT}{{\OP{T}}}
\newcommand*{\OPU}{{\OP{U}}}
\newcommand*{\OPV}{{\OP{V}}}
\newcommand*{\OPW}{{\OP{W}}}
\newcommand*{\OPX}{{\OP{X}}}
\newcommand*{\OPY}{{\OP{Y}}}
\newcommand*{\OPZ}{{\OP{Z}}}

\newcommand*{\FT}{\OP{F}}
\newcommand*{\ID}{\OP{I}}
\newcommand*{\TV}{{\ensuremath{\text{TV}}}}


% Bold vectors
\newcommand*{\BDNULL}{{\boldsymbol{0}}}
\newcommand*{\BDZERO}{{\boldsymbol{0}}}
\newcommand*{\BDONE}{{\boldsymbol{1}}}
\newcommand*{\BDa}{{\boldsymbol{a}}}
\newcommand*{\BDb}{{\boldsymbol{b}}}
\newcommand*{\BDc}{{\boldsymbol{c}}}
\newcommand*{\BDd}{{\boldsymbol{d}}}
\newcommand*{\BDe}{{\boldsymbol{e}}}
\newcommand*{\BDf}{{\boldsymbol{f}}}
\newcommand*{\BDg}{{\boldsymbol{g}}}
\newcommand*{\BDh}{{\boldsymbol{h}}}
\newcommand*{\BDi}{{\boldsymbol{i}}}
\newcommand*{\BDj}{{\boldsymbol{j}}}
\newcommand*{\BDk}{{\boldsymbol{k}}}
\newcommand*{\BDl}{{\boldsymbol{l}}}
\newcommand*{\BDm}{{\boldsymbol{m}}}
\newcommand*{\BDn}{{\boldsymbol{n}}}
\newcommand*{\BDo}{{\boldsymbol{o}}}
\newcommand*{\BDp}{{\boldsymbol{p}}}
\newcommand*{\BDq}{{\boldsymbol{q}}}
\newcommand*{\BDr}{{\boldsymbol{r}}}
\newcommand*{\BDs}{{\boldsymbol{s}}}
\newcommand*{\BDt}{{\boldsymbol{t}}}
\newcommand*{\BDu}{{\boldsymbol{u}}}
\newcommand*{\BDv}{{\boldsymbol{v}}}
\newcommand*{\BDw}{{\boldsymbol{w}}}
\newcommand*{\BDx}{{\boldsymbol{x}}}
\newcommand*{\BDy}{{\boldsymbol{y}}}
\newcommand*{\BDz}{{\boldsymbol{z}}}
\newcommand*{\BDA}{{\boldsymbol{A}}}
\newcommand*{\BDB}{{\boldsymbol{B}}}
\newcommand*{\BDC}{{\boldsymbol{C}}}
\newcommand*{\BDD}{{\boldsymbol{D}}}
\newcommand*{\BDE}{{\boldsymbol{E}}}
\newcommand*{\BDF}{{\boldsymbol{F}}}
\newcommand*{\BDG}{{\boldsymbol{G}}}
\newcommand*{\BDH}{{\boldsymbol{H}}}
\newcommand*{\BDI}{{\boldsymbol{I}}}
\newcommand*{\BDJ}{{\boldsymbol{J}}}
\newcommand*{\BDK}{{\boldsymbol{K}}}
\newcommand*{\BDL}{{\boldsymbol{L}}}
\newcommand*{\BDM}{{\boldsymbol{M}}}
\newcommand*{\BDN}{{\boldsymbol{N}}}
\newcommand*{\BDO}{{\boldsymbol{O}}}
\newcommand*{\BDP}{{\boldsymbol{P}}}
\newcommand*{\BDQ}{{\boldsymbol{Q}}}
\newcommand*{\BDR}{{\boldsymbol{R}}}
\newcommand*{\BDS}{{\boldsymbol{S}}}
\newcommand*{\BDT}{{\boldsymbol{T}}}
\newcommand*{\BDU}{{\boldsymbol{U}}}
\newcommand*{\BDV}{{\boldsymbol{V}}}
\newcommand*{\BDW}{{\boldsymbol{W}}}
\newcommand*{\BDX}{{\boldsymbol{X}}}
\newcommand*{\BDY}{{\boldsymbol{Y}}}
\newcommand*{\BDZ}{{\boldsymbol{Z}}}
\newcommand*{\BDalpha}{{\boldsymbol{\alpha}}}
\newcommand*{\BDbeta}{{\boldsymbol{\beta}}}
\newcommand*{\BDgamma}{{\boldsymbol{\gamma}}}
\newcommand*{\BDdelta}{{\boldsymbol{\delta}}}
\newcommand*{\BDepsilon}{{\boldsymbol{\epsilon}}}
\newcommand*{\BDeta}{{\boldsymbol{\eta}}}
\newcommand*{\BDkappa}{{\boldsymbol{\kappa}}}
\newcommand*{\BDmu}{\boldsymbol{\mu}}
\newcommand*{\BDnu}{\boldsymbol{\nu}}
\newcommand*{\BDsigma}{\boldsymbol{\sigma}}
\newcommand*{\BDzeta}{{\boldsymbol{\zeta}}}
\newcommand*{\BDomega}{{\boldsymbol{\omega}}}
\newcommand*{\BDtheta}{{\boldsymbol{\theta}}}
\newcommand*{\BDxi}{{\boldsymbol{\xi}}}
\newcommand*{\BDAlpha}{{\boldsymbol{\Alpha}}}
\newcommand*{\BDBeta}{{\boldsymbol{\Beta}}}
\newcommand*{\BDGamma}{{\boldsymbol{\Gamma}}}
\newcommand*{\BDDelta}{{\boldsymbol{\Delta}}}
\newcommand*{\BDEpsilon}{{\boldsymbol{\Epsilon}}}
\newcommand*{\BDEta}{{\boldsymbol{\Eta}}}
\newcommand*{\BDKappa}{{\boldsymbol{\Kappa}}}
\newcommand*{\BDZeta}{{\boldsymbol{\Zeta}}}
\newcommand*{\BDOmega}{{\boldsymbol{\Omega}}}
\newcommand*{\BDTheta}{{\boldsymbol{\Theta}}}
\newcommand*{\BDXi}{{\boldsymbol{\Xi}}}


% Useful math delimiter macros using mathtools
% A macro \CMD supports three usage types:
% 1. \CMD{<arg>}  --  standard size delimiters
% 2. \CMD[<size modifier>]{<arg>}  --  adds <size modifier> to the delimiters, e.g. \big, \Big, \bigg, \Bigg
% 3. \CMD*{<arg>}  --  adds \left and \right to the respective delimiters

% SET
% Syntax: \SET{ <element> \GIVEN <condition> }
\providecommand\GIVEN{}  % just to make sure it exists
% can be useful to refer to this outside \SET
\newcommand*{\SETSYMBOL}[1][]{\nonscript\:#1\vert\nonscript\:\mathopen{}\allowbreak}
\DeclarePairedDelimiterX{\SET}[1]{\lbrace}{\rbrace}{\renewcommand \GIVEN{\SETSYMBOL[\delimsize]} #1 }

% INTERVALS: (C)losed, (O)pen, (R)ight-open or (L)eft-open
\DeclarePairedDelimiterX{\CINTERV}[2]{[}{]}{{#1},{#2}}
\DeclarePairedDelimiterX{\OINTERV}[2]{(}{)}{{#1},{#2}}
\DeclarePairedDelimiterX{\RINTERV}[2]{[}{)}{{#1},{#2}}
\DeclarePairedDelimiterX{\LINTERV}[2]{(}{]}{{#1},{#2}}

% ABS, NORM, INNER etc.
% Empty arguments are replaced with \cdot, i.e., \NORM{} is equivalent to \NORM{\:\cdot\:}
\DeclarePairedDelimiterX{\ABS}[1]{\lvert}{\rvert}{\ifblank{#1}{\:\cdot\:}{#1}}

% Syntax: \NORM{<arg>} or \NORMIN{<subscript>}{<arg>}
\DeclarePairedDelimiterX{\NORM}[1]{\lVert}{\rVert}{\ifblank{#1}{\,\cdot\,}{#1}}

% Syntax: \INNER{<arg1>}{<arg2>} or \INNERIN{<subscript>}{<arg1>}{<arg2>}
\DeclarePairedDelimiterX{\INNER}[2]{\langle}{\rangle}{\ifblank{#1}{\:\cdot\,}{#1},\ifblank{#2}{\,\cdot\,}{\, #2}}

% Math operators
\DeclareMathOperator*{\ARGINF}{arg\,inf}
\DeclareMathOperator*{\ARGMAX}{arg\,max}
\DeclareMathOperator*{\ARGMIN}{arg\,min}
\DeclareMathOperator*{\ARGSUP}{arg\,sup}
\DeclareMathOperator{\DEFEQ}{{\coloneqq}}
\DeclareMathOperator{\DET}{det}
\DeclareMathOperator{\DIAG}{diag}
\DeclareMathOperator{\DIM}{dim}
\DeclareMathOperator{\DIV}{div}
\DeclareMathOperator{\EMBED}{\hookrightarrow}
\DeclareMathOperator{\EQDEF}{{\eqqcolon}}
\DeclareMathOperator{\GRAD}{grad}
\DeclareMathOperator{\KER}{ker}
\DeclareMathOperator{\NULL}{N}
\DeclareMathOperator{\PROX}{prox}
\DeclareMathOperator{\RAN}{ran}
\DeclareMathOperator{\RANGE}{range}
\DeclareMathOperator{\RANK}{rank}
\DeclareMathOperator{\SHOULDEQ}{{\stackrel{!}{=}}}
\DeclareMathOperator{\SIGN}{sign}
\DeclareMathOperator{\SINC}{sinc}
\DeclareMathOperator{\SPAN}{span}
\DeclareMathOperator{\SUPP}{supp}
\DeclareMathOperator{\WEAKTO}{\rightharpoonup}
\DeclareMathOperator{\WEAKTO*}{\mathop{\rightharpoonup}^{*}}

% Other math stuff

\newcommand*{\BIGO}[0]{\ensuremath{\mathcal{O}}}
\newcommand*{\CCONJ}[1]{{\ensuremath{\overline{#1}}}}
\newcommand*{\D}{{\ensuremath{\mathrm{d}}}}
\newcommand*{\DUNION}{\ensuremath{\stackrel{.}{\cup}}}
\newcommand*{\EQ}[0]{\ensuremath{\Leftrightarrow}}
\newcommand*{\EPS}{{\ensuremath{\varepsilon}}}
\newcommand*{\EVALAT}[3]{{\ensuremath{\left. \vphantom{g_{g_g}} {#1} \right|_{#2}^{#3}}}}
\newcommand*{\FUNCRESTR}[2]{{\ensuremath{\left. \vphantom{g_{g_g}} {#1} \right|_{#2}}}}
\newcommand*{\HALF}{{\ensuremath{\nicefrac{1}{2}}}}
\newcommand*{\HERM}[1]{{\ensuremath{#1^{\mathrm{H}}}}}
\newcommand*{\I}[0]{\ensuremath{\mathit{i}}}
\newcommand*{\IMAG}[0]{\ensuremath{\mathrm{Im}}}
\newcommand*{\INDICATOR}{{\ensuremath{\iota}}}
\newcommand*{\INV}[1]{\ensuremath{\frac{1}{#1}}}
\newcommand*{\LAPLACE}[0]{\ensuremath{\varDelta}}
\newcommand*{\LONGEQUIV}[0]{\ensuremath{\Longleftrightarrow}}
\newcommand*{\PARTD}[2]{{\ensuremath{\frac{\partial #1}{\partial #2}}}}
\newcommand*{\PDATZERO}[1]{{\ensuremath{\left. \frac{\partial}{\partial #1} \right|_{#1=0}}}}
\newcommand*{\REAL}[0]{\ensuremath{\mathrm{Re}}}
\newcommand*{\SMALLO}[0]{\ensuremath{o}}
\newcommand*{\TRANSP}[1]{{\ensuremath{#1^{\mathrm{T}}}}}
\newcommand*{\TSTYLE}[0]{\ensuremath{\textstyle}}


% Special sets

\newcommand*{\NN}[0]{{\ensuremath{\mathbb{N}}}}
\newcommand*{\ZZ}[0]{{\ensuremath{\mathbb{Z}}}}
\newcommand*{\RR}[0]{{\ensuremath{\mathbb{R}}}}
\newcommand*{\CC}[0]{{\ensuremath{\mathbb{C}}}}

\newcommand*{\DOMAIN}{\ensuremath{\mathscr{D}}}
\newcommand*{\SPHERE}{\ensuremath{\mathcal{S}}}
\newcommand*{\SCHWARZ}{\ensuremath{S}}

% Custom math environments
\newenvironment{lrcases}{\left\lbrace\begin{aligned}}{\end{aligned}\right\rbrace}

